<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thermals Analysis Worksheet - Day 1 & 2</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <style>
        @page {
            size: A4 portrait;
            margin: 0;
        }
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            -webkit-print-color-adjust: exact;
        }
        .sheet {
            width: 210mm;
            height: 297mm;
            background: white;
            margin: 10mm auto;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            page-break-after: always;
        }
        @media print {
            html, body {
                width: 210mm;
                margin: 0;
                padding: 0;
            }
            body { background: none; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .sheet { 
                margin: 0; 
                box-shadow: none; 
                width: 210mm; 
                height: 297mm; 
                overflow: visible;
            }
            .no-print { display: none; }
        }
        
        /* Navigation */
        nav {
            background: #333;
            padding: 10px;
            text-align: center;
            font-family: sans-serif;
        }
        nav a {
            color: white;
            text-decoration: none;
            margin: 0 15px;
            font-weight: bold;
        }

        /* Header */
        header {
            position: absolute;
            top: 15mm;
            left: 10mm;
            right: 10mm;
            height: 15mm;
            border-bottom: 2px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            padding-bottom: 5px;
        }
        h1 {
            font-size: 22px;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #333;
        }
        .meta {
            font-size: 11px;
            color: #555;
        }

        /* Chart Area */
        .chart-container {
            position: absolute;
            top: 35mm;
            left: 10mm;
            right: 10mm;
            bottom: 15mm;
            border-left: 2px solid #333;
            border-bottom: 2px solid #333;
        }

        /* Grid Lines */
        .grid-line {
            position: absolute;
            left: 0;
            right: 0;
            border-top: 1px dotted #bbb;
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }
        .label-container {
            background: white;
            padding-left: 5px;
            font-family: monospace;
            font-size: 11px;
            display: flex;
            align-items: center;
            width: 130px;
            justify-content: space-between;
        }
        .temp-c { font-weight: bold; color: #000; }
        .temp-f { color: #666; margin-left: 10px; }
        .alt-tag { font-weight: bold; color: #333; }

        /* Mountain Graphic & Annotations */
        .graphic-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }
        
        .annotation {
            position: absolute;
            font-size: 11px;
            background: rgba(255,255,255,0.9);
            padding: 4px 8px;
            border: 1px solid #333;
            border-radius: 2px;
            z-index: 5;
            box-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        .watermark {
            position: absolute;
            top: 25%;
            right: 45%;
            font-size: 60px;
            color: rgba(0,0,0,0.05);
            transform: rotate(-30deg);
            z-index: 0;
            font-weight: bold;
            text-transform: uppercase;
        }

        /* Control Panel */
        .controls {
            background: #fff;
            padding: 15px;
            margin: 10px auto;
            max-width: 800px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: sans-serif;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .control-group {
            flex: 1;
            min-width: 250px;
        }
        .control-group h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: #333;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }
        .input-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            font-size: 13px;
        }
        .input-row label { width: 120px; }
        .input-row input {
            width: 50px;
            padding: 4px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }
        .btn-reset {
            background: #666;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            margin-top: 10px;
        }
        .btn-reset:hover { background: #444; }
        .controls {
            max-width: 1000px;
        }
        .control-grid-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 5px;
            margin-top: 10px;
            background: #f9f9f9;
            padding: 10px;
            border-radius: 4px;
        }
        .grid-input-item {
            font-size: 11px;
            display: flex;
            flex-direction: column;
        }
        .grid-input-item input {
            width: 45px;
        }

    </style>
</head>
<body>

    <nav class="no-print">
        <a href="index.html">Thermals Worksheet</a>
        <a href="mixing-ratio.html">Mixing Ratio</a>
        <a href="states-of-matter.html">States of Matter</a>
        <a href="lectures.html">Lectures</a>
        <a href="relative-humidity.html">RH Simulator</a>
        <a href="weather-tools.html">Live Weather</a>
    </nav>
    <div class="no-print controls"><div class="control-group"><h3>Surface Values (°C)</h3>
            <div class="input-row">
                <label>Mountain (Left):</label>
                Temperature: <input type="number" id="input-s1-t" value="18" step="1" onchange="updateValues()">
                DP: <input type="number" id="input-s1-d" value="3" step="1" onchange="updateValues()">
            </div>
            <div class="input-row">
                <label>Mid-Valley:</label>
                Temperature: <input type="number" id="input-s2-t" value="24" step="1" onchange="updateValues()">
                DP: <input type="number" id="input-s2-d" value="9" step="1" onchange="updateValues()">
            </div>
            <div class="input-row">
                <label>Ocean (Right):</label>
                Temperature: <input type="number" id="input-s3-t" value="29" step="1" onchange="updateValues()">
                DP: <input type="number" id="input-s3-d" value="13" step="1" onchange="updateValues()">
            </div>
            
        
            <div class="input-row">
                <button class="btn-reset" style="background: #2a6496; margin-right: 10px;" onclick="updateValues(true)">Apply Changes</button>
                
            </div>
            

            <div class="input-row">
                
                <button class="btn-reset" onclick="resetDefaults()">Reset to Defaults</button>
            </div>
            <div id="status-msg" style="margin-top: 10px; font-size: 12px; font-weight: bold; color: #28a745; height: 15px;"></div>
        </div>
        
        <div class="control-group">
            <h3>Custom Day 3 Environmental Lapse Rate</h3>
            <div class="input-row">
                <label>1,000' Base Temp (°C):</label>
                <input type="number" id="input-d3-base" value="29" step="1">
            </div>
            <div class="input-row">
                <label>Lapse Rate (°C per 1,000ft):</label>
                <input type="number" id="input-d3-rate" value="2" step="0.1">
            </div>
            <button class="btn-reset" style="background: #2a6496;" onclick="applyLapseRate()">Apply Lapse Rate</button>
            
            <div class="control-grid-inputs">
                <!-- Manual overrides for 1k to 16k -->
                <script>
                    const container = document.currentScript.parentElement;
                    for (let alt = 1000; alt <= 16000; alt += 1000) {
                        const div = document.createElement('div');
                        div.className = 'grid-input-item';
                        div.innerHTML = `<label>${alt.toLocaleString()}'</label>
                                         <input type="number" id="manual-d3-${alt}" value="0" step="1" oninput="updateCustomDayFromManual(${alt})">`;
                        container.appendChild(div);
                    }
                </script>
            </div>
        </div>
<div style="flex: 1; font-size: 12px; color: #666;">
            <p><strong>Instructions:</strong> Change the surface Temperature and dew point (DP) temperatures in Celsius. Fahrenheit values will update automatically. Changes apply to both Day 1 and Day 2 sheets. Use the Print button to save as PDF or print.</p>
        </div>
    </div>


    <div class="no-print" style="position: fixed; top: 60px; right: 10px; z-index: 100;">
        <button onclick="window.print()" style="padding: 10px 20px; cursor: pointer; font-size: 14px; background: #333; color: white; border: none; border-radius: 4px;">Print Worksheet</button>
    </div>

    <!-- PAGE 1: DAY 1 -->
    <div class="sheet">
        <header>
            <h1>Thermals Worksheet DAY 1</h1>
            <div class="meta">
                Date: _______________ &nbsp;|&nbsp; Location: _______________<br>
                <strong>DALR = 3°C / 5.5°F per 1,000ft</strong> &nbsp;|&nbsp; <strong>MALR = 1.5°C / 3°F per 1,000ft</strong>
            </div>
        </header>

        <div class="watermark">atmosphere</div>

        <div class="chart-container">
            <svg class="graphic-overlay" viewBox="0 0 1000 1000" preserveAspectRatio="none">
                <path d="M 0,560 C 20,555 35,548 50,540 C 65,545 80,555 100,558 C 120,562 135,568 150,580 C 180,600 200,615 230,635 C 260,652 280,660 300,670 L 320,675 L 340,680 C 370,692 400,705 430,720 C 480,745 520,765 560,785 C 600,805 630,820 660,840 C 690,858 710,875 730,895 C 750,915 765,935 775,950 L 780,960 L 780,1000 L 0,1000 Z" fill="rgba(200,200,200,0.15)" stroke="black" stroke-width="2.5" />
                <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="black" /></marker></defs>
                <line x1="170" y1="615" x2="105" y2="560" stroke="black" stroke-width="2.5" marker-end="url(#arrowhead)" />
                <line x1="380" y1="790" x2="490" y2="750" stroke="black" stroke-width="2.5" marker-end="url(#arrowhead)" />
                <line x1="670" y1="930" x2="755" y2="940" stroke="black" stroke-width="2.5" marker-end="url(#arrowhead)" />
                <path d="M 780,965 C 790,955 800,955 810,965 C 820,975 830,975 840,965 C 850,955 860,955 870,965 C 880,975 890,975 900,965 C 910,955 920,955 930,965 C 940,975 950,975 960,965 C 970,955 980,955 990,965 L 1000,965" stroke="#4a8ab5" stroke-width="2" fill="none" />
                <path d="M 790,978 C 800,968 810,968 820,978 C 830,988 840,988 850,978 C 860,968 870,968 880,978 C 890,988 900,988 910,978 C 920,968 930,968 940,978 C 950,988 960,988 970,978 C 980,968 990,968 1000,978" stroke="#4a8ab5" stroke-width="1.8" fill="none" />
                <path d="M 800,990 C 810,982 820,982 830,990 C 840,998 850,998 860,990 C 870,982 880,982 890,990 C 900,998 910,998 920,990 C 930,982 940,982 950,990 C 960,998 970,998 980,990 C 990,982 1000,982 1000,990" stroke="#4a8ab5" stroke-width="1.5" fill="none" />
            </svg>

            
            <div class="annotation" style="top: 62%; left: 2%;"><strong>At surface:</strong> <span id="d1-s1-t-c">18</span>°C / <span id="d1-s1-t-f">64</span>°F<br>Dew Point = <span id="d1-s1-d-c">3</span>°C / <span id="d1-s1-d-f">37</span>°F</div>
            <div class="annotation" style="top: 79%; left: 25%;"><strong>At surface:</strong> <span id="d1-s2-t-c">24</span>°C / <span id="d1-s2-t-f">76</span>°F<br>Dew Point = <span id="d1-s2-d-c">9</span>°C / <span id="d1-s2-d-f">49</span>°F</div>
            <div class="annotation" style="top: 93%; left: 48.5%;"><strong>At surface:</strong> <span id="d1-s3-t-c">29</span>°C / <span id="d1-s3-t-f">85</span>°F<br>Dew Point = <span id="d1-s3-d-c">13</span>°C / <span id="d1-s3-d-f">55</span>°F</div>

            <div style="position: absolute; top: 75%; left: 10%; font-size: 24px; font-style: italic; color: #777; font-family: serif; opacity: 0.4;">Mountain</div>

            <div class="grid-line" style="top: 0%;"><div class="label-container"><span class="temp-c">8°C</span><span class="temp-f">/ 47°F</span><span class="alt-tag">16,000'</span></div></div>
            <div class="grid-line" style="top: 6.25%;"><div class="label-container"><span class="temp-c">-2°C</span><span class="temp-f">/ 29°F</span><span class="alt-tag">15,000'</span></div></div>
            <div class="grid-line" style="top: 12.5%;"><div class="label-container"><span class="temp-c">-1°C</span><span class="temp-f">/ 30°F</span><span class="alt-tag">14,000'</span></div></div>
            <div class="grid-line" style="top: 18.75%;"><div class="label-container"><span class="temp-c">0°C</span><span class="temp-f">/ 32°F</span><span class="alt-tag">13,000'</span></div></div>
            <div class="grid-line" style="top: 25%;"><div class="label-container"><span class="temp-c">2°C</span><span class="temp-f">/ 36°F</span><span class="alt-tag">12,000'</span></div></div>
            <div class="grid-line" style="top: 31.25%;"><div class="label-container"><span class="temp-c">6°C</span><span class="temp-f">/ 42°F</span><span class="alt-tag">11,000'</span></div></div>
            <div class="grid-line" style="top: 37.5%;"><div class="label-container"><span class="temp-c">6°C</span><span class="temp-f">/ 43°F</span><span class="alt-tag">10,000'</span></div></div>
            <div class="grid-line" style="top: 43.75%;"><div class="label-container"><span class="temp-c">8°C</span><span class="temp-f">/ 46°F</span><span class="alt-tag"> 9,000'</span></div></div>
            <div class="grid-line" style="top: 50%;"><div class="label-container"><span class="temp-c">9°C</span><span class="temp-f">/ 48°F</span><span class="alt-tag"> 8,000'</span></div></div>
            <div class="grid-line" style="top: 56.25%;"><div class="label-container"><span class="temp-c">11°C</span><span class="temp-f">/ 52°F</span><span class="alt-tag"> 7,000'</span></div></div>
            <div class="grid-line" style="top: 62.5%;"><div class="label-container"><span class="temp-c">14°C</span><span class="temp-f">/ 57°F</span><span class="alt-tag"> 6,000'</span></div></div>
            <div class="grid-line" style="top: 68.75%;"><div class="label-container"><span class="temp-c">17°C</span><span class="temp-f">/ 62°F</span><span class="alt-tag"> 5,000'</span></div></div>
            <div class="grid-line" style="top: 75%;"><div class="label-container"><span class="temp-c">21°C</span><span class="temp-f">/ 70°F</span><span class="alt-tag"> 4,000'</span></div></div>
            <div class="grid-line" style="top: 81.25%;"><div class="label-container"><span class="temp-c">22°C</span><span class="temp-f">/ 72°F</span><span class="alt-tag"> 3,000'</span></div></div>
            <div class="grid-line" style="top: 87.5%;"><div class="label-container"><span class="temp-c">26°C</span><span class="temp-f">/ 78°F</span><span class="alt-tag"> 2,000'</span></div></div>
            <div class="grid-line" style="top: 93.75%;"><div class="label-container"><span class="temp-c">29°C</span><span class="temp-f">/ 84°F</span><span class="alt-tag"> 1,000'</span></div></div>
        </div>
    </div>

    <!-- PAGE 2: DAY 2 -->
    <div class="sheet">
        <header>
            <h1>Thermals Worksheet DAY 2</h1>
            <div class="meta">
                Date: _______________ &nbsp;|&nbsp; Location: _______________<br>
                <strong>DALR = 3°C / 5.5°F per 1,000ft</strong> &nbsp;|&nbsp; <strong>MALR = 1.5°C / 3°F per 1,000ft</strong>
            </div>
        </header>

        <div class="watermark">atmosphere</div>

        <div class="chart-container">
            <svg class="graphic-overlay" viewBox="0 0 1000 1000" preserveAspectRatio="none">
                <path d="M 0,560 C 20,555 35,548 50,540 C 65,545 80,555 100,558 C 120,562 135,568 150,580 C 180,600 200,615 230,635 C 260,652 280,660 300,670 L 320,675 L 340,680 C 370,692 400,705 430,720 C 480,745 520,765 560,785 C 600,805 630,820 660,840 C 690,858 710,875 730,895 C 750,915 765,935 775,950 L 780,960 L 780,1000 L 0,1000 Z" fill="rgba(200,200,200,0.15)" stroke="black" stroke-width="2.5" />
                <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="black" /></marker></defs>
                <line x1="170" y1="615" x2="105" y2="560" stroke="black" stroke-width="2.5" marker-end="url(#arrowhead)" />
                <line x1="380" y1="790" x2="490" y2="750" stroke="black" stroke-width="2.5" marker-end="url(#arrowhead)" />
                <line x1="670" y1="930" x2="755" y2="940" stroke="black" stroke-width="2.5" marker-end="url(#arrowhead)" />
                <path d="M 780,965 C 790,955 800,955 810,965 C 820,975 830,975 840,965 C 850,955 860,955 870,965 C 880,975 890,975 900,965 C 910,955 920,955 930,965 C 940,975 950,975 960,965 C 970,955 980,955 990,965 L 1000,965" stroke="#4a8ab5" stroke-width="2" fill="none" />
                <path d="M 790,978 C 800,968 810,968 820,978 C 830,988 840,988 850,978 C 860,968 870,968 880,978 C 890,988 900,988 910,978 C 920,968 930,968 940,978 C 950,988 960,988 970,978 C 980,968 990,968 1000,978" stroke="#4a8ab5" stroke-width="1.8" fill="none" />
                <path d="M 800,990 C 810,982 820,982 830,990 C 840,998 850,998 860,990 C 870,982 880,982 890,990 C 900,998 910,998 920,990 C 930,982 940,982 950,990 C 960,998 970,998 980,990 C 990,982 1000,982 1000,990" stroke="#4a8ab5" stroke-width="1.5" fill="none" />
            </svg>

            <div style="position: absolute; top: 0; right: 0; width: 200px; height: 40.625%; z-index: 1; pointer-events: none;">
                <svg width="100%" height="100%" preserveAspectRatio="none" viewBox="0 0 140 400">
                    <path d="M 140,0 L 140,400 L 40,400 L 10,370 L 40,340 L 10,310 L 40,280 L 10,250 L 40,220 L 10,190 L 40,160 L 10,130 L 40,100 L 10,70 L 40,40 L 10,10 L 20,0 Z" fill="rgba(74, 138, 181, 0.2)" stroke="rgba(74, 138, 181, 0.4)" stroke-width="2" />
                </svg>
            </div>
            <div style="position: absolute; top: 18.75%; right: 60px; transform: translateY(-50%) rotate(-90deg); white-space: nowrap; font-size: 20px; font-weight: bold; color: #4a8ab5; opacity: 0.8; z-index: 2; font-style: italic;">Cold air moves in from the north</div>

            
            <div class="annotation" style="top: 62%; left: 2%;"><strong>At surface:</strong> <span id="d2-s1-t-c">18</span>°C / <span id="d2-s1-t-f">64</span>°F<br>Dew Point = <span id="d2-s1-d-c">3</span>°C / <span id="d2-s1-d-f">37</span>°F</div>
            <div class="annotation" style="top: 79%; left: 25%;"><strong>At surface:</strong> <span id="d2-s2-t-c">24</span>°C / <span id="d2-s2-t-f">76</span>°F<br>Dew Point = <span id="d2-s2-d-c">9</span>°C / <span id="d2-s2-d-f">49</span>°F</div>
            <div class="annotation" style="top: 93%; left: 48.5%;"><strong>At surface:</strong> <span id="d2-s3-t-c">29</span>°C / <span id="d2-s3-t-f">85</span>°F<br>Dew Point = <span id="d2-s3-d-c">13</span>°C / <span id="d2-s3-d-f">55</span>°F</div>

            <div style="position: absolute; top: 75%; left: 10%; font-size: 24px; font-style: italic; color: #777; font-family: serif; opacity: 0.4;">Mountain</div>

            <div class="grid-line" style="top: 0%;"><div class="label-container"><span class="temp-c">-9°C</span><span class="temp-f">/ 16°F</span><span class="alt-tag">16,000'</span></div></div>
            <div class="grid-line" style="top: 6.25%;"><div class="label-container"><span class="temp-c">-8°C</span><span class="temp-f">/ 18°F</span><span class="alt-tag">15,000'</span></div></div>
            <div class="grid-line" style="top: 12.5%;"><div class="label-container"><span class="temp-c">-6°C</span><span class="temp-f">/ 22°F</span><span class="alt-tag">14,000'</span></div></div>
            <div class="grid-line" style="top: 18.75%;"><div class="label-container"><span class="temp-c">-3°C</span><span class="temp-f">/ 26°F</span><span class="alt-tag">13,000'</span></div></div>
            <div class="grid-line" style="top: 25%;"><div class="label-container"><span class="temp-c">0°C</span><span class="temp-f">/ 32°F</span><span class="alt-tag">12,000'</span></div></div>
            <div class="grid-line" style="top: 31.25%;"><div class="label-container"><span class="temp-c">4°C</span><span class="temp-f">/ 39°F</span><span class="alt-tag">11,000'</span></div></div>
            <div class="grid-line" style="top: 37.5%;"><div class="label-container"><span class="temp-c">6°C</span><span class="temp-f">/ 42°F</span><span class="alt-tag">10,000'</span></div></div>
            <div class="grid-line" style="top: 43.75%;"><div class="label-container"><span class="temp-c">8°C</span><span class="temp-f">/ 46°F</span><span class="alt-tag"> 9,000'</span></div></div>
            <div class="grid-line" style="top: 50%;"><div class="label-container"><span class="temp-c">9°C</span><span class="temp-f">/ 48°F</span><span class="alt-tag"> 8,000'</span></div></div>
            <div class="grid-line" style="top: 56.25%;"><div class="label-container"><span class="temp-c">11°C</span><span class="temp-f">/ 52°F</span><span class="alt-tag"> 7,000'</span></div></div>
            <div class="grid-line" style="top: 62.5%;"><div class="label-container"><span class="temp-c">14°C</span><span class="temp-f">/ 57°F</span><span class="alt-tag"> 6,000'</span></div></div>
            <div class="grid-line" style="top: 68.75%;"><div class="label-container"><span class="temp-c">17°C</span><span class="temp-f">/ 62°F</span><span class="alt-tag"> 5,000'</span></div></div>
            <div class="grid-line" style="top: 75%;"><div class="label-container"><span class="temp-c">21°C</span><span class="temp-f">/ 70°F</span><span class="alt-tag"> 4,000'</span></div></div>
            <div class="grid-line" style="top: 81.25%;"><div class="label-container"><span class="temp-c">22°C</span><span class="temp-f">/ 72°F</span><span class="alt-tag"> 3,000'</span></div></div>
            <div class="grid-line" style="top: 87.5%;"><div class="label-container"><span class="temp-c">26°C</span><span class="temp-f">/ 78°F</span><span class="alt-tag"> 2,000'</span></div></div>
            <div class="grid-line" style="top: 93.75%;"><div class="label-container"><span class="temp-c">29°C</span><span class="temp-f">/ 84°F</span><span class="alt-tag"> 1,000'</span></div></div>
        </div>
    </div>


    
    
    <script>
        const defaults = {
            s1: { t: 18, d: 3 },
            s2: { t: 24, d: 9 },
            s3: { t: 29, d: 13 }
        };

        function cToF(c) {
            return Math.round(c * 1.8 + 32);
        }

        function updateValues(showStatus = false) {
            for (let i = 1; i <= 3; i++) {
                const tInput = document.getElementById('input-s' + i + '-t');
                const dInput = document.getElementById('input-s' + i + '-d');
                if (!tInput || !dInput) continue;

                const t = parseFloat(tInput.value);
                const d = parseFloat(dInput.value);
                
                // Update all instances on Day 1 (day 1) and Day 2 (day 2)
                [1, 2, 3].forEach(dayNum => {
                    const tC = document.getElementById('d' + dayNum + '-s' + i + '-t-c');
                    const tF = document.getElementById('d' + dayNum + '-s' + i + '-t-f');
                    const dC = document.getElementById('d' + dayNum + '-s' + i + '-d-c');
                    const dF = document.getElementById('d' + dayNum + '-s' + i + '-d-f');
                    
                    if(tC) tC.textContent = t;
                    if(tF) tF.textContent = cToF(t);
                    if(dC) dC.textContent = d;
                    if(dF) dF.textContent = cToF(d);
                });
            }

            if (showStatus === true) {
                const msg = document.getElementById('status-msg');
                if (msg) {
                    msg.textContent = '✓ Worksheet updated!';
                    setTimeout(() => { msg.textContent = ''; }, 2000);
                }
            }
        }

        function resetDefaults() {
            for (let i = 1; i <= 3; i++) {
                const tInput = document.getElementById('input-s' + i + '-t');
                const dInput = document.getElementById('input-s' + i + '-d');
                if (tInput) tInput.value = defaults['s' + i].t;
                if (dInput) dInput.value = defaults['s' + i].d;
            }
            updateValues(true);
        }


        function applyLapseRate() {
            const baseTemp = parseFloat(document.getElementById('input-d3-base').value);
            const rate = parseFloat(document.getElementById('input-d3-rate').value);
            
            for (let alt = 1000; alt <= 16000; alt += 1000) {
                // Calculate: baseTemp - ((alt - 1000) / 1000 * rate)
                const currentTemp = Math.round((baseTemp - ((alt - 1000) / 1000 * rate)) * 10) / 10;
                
                // Update manual input box
                const input = document.getElementById('manual-d3-' + alt);
                if (input) input.value = currentTemp;
                
                // Update worksheet
                const elC = document.getElementById('d3-alt-' + alt + '-c');
                const elF = document.getElementById('d3-alt-' + alt + '-f');
                if (elC) elC.textContent = currentTemp + '°C';
                if (elF) elF.textContent = '/ ' + cToF(currentTemp) + '°F';
            }
        }

        function updateCustomDayFromManual(alt) {
            const val = parseFloat(document.getElementById('manual-d3-' + alt).value);
            const elC = document.getElementById('d3-alt-' + alt + '-c');
            const elF = document.getElementById('d3-alt-' + alt + '-f');
            if (elC) elC.textContent = val + '°C';
            if (elF) elF.textContent = '/ ' + cToF(val) + '°F';
        }

        window.onload = function() {
            applyLapseRate();
            updateValues();
        };
    </script>



    <!-- PAGE 3: CUSTOM DAY -->
    <div class="sheet">
        <header>
            <h1>Thermals CUSTOM DAY 3</h1>
            <div class="meta">
                Date: _______________ &nbsp;|&nbsp; Location: _______________<br>
                <strong>DALR = 3°C / 5.5°F per 1,000ft</strong> &nbsp;|&nbsp; <strong>MALR = 1.5°C / 3°F per 1,000ft</strong>
            </div>
        </header>

        <div class="watermark">atmosphere</div>

        <div class="chart-container">
            <svg class="graphic-overlay" viewBox="0 0 1000 1000" preserveAspectRatio="none">
                <path d="M 0,560 C 20,555 35,548 50,540 C 65,545 80,555 100,558 C 120,562 135,568 150,580 C 180,600 200,615 230,635 C 260,652 280,660 300,670 L 320,675 L 340,680 C 370,692 400,705 430,720 C 480,745 520,765 560,785 C 600,805 630,820 660,840 C 690,858 710,875 730,895 C 750,915 765,935 775,950 L 780,960 L 780,1000 L 0,1000 Z" fill="rgba(200,200,200,0.15)" stroke="black" stroke-width="2.5" />
                <defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="black" /></marker></defs>
                <line x1="170" y1="615" x2="105" y2="560" stroke="black" stroke-width="2.5" marker-end="url(#arrowhead)" />
                <line x1="380" y1="790" x2="490" y2="750" stroke="black" stroke-width="2.5" marker-end="url(#arrowhead)" />
                <line x1="670" y1="930" x2="755" y2="940" stroke="black" stroke-width="2.5" marker-end="url(#arrowhead)" />
                <path d="M 780,965 C 790,955 800,955 810,965 C 820,975 830,975 840,965 C 850,955 860,955 870,965 C 880,975 890,975 900,965 C 910,955 920,955 930,965 C 940,975 950,975 960,965 C 970,955 980,955 990,965 L 1000,965" stroke="#4a8ab5" stroke-width="2" fill="none" />
                <path d="M 790,978 C 800,968 810,968 820,978 C 830,988 840,988 850,978 C 860,968 870,968 880,978 C 890,988 900,988 910,978 C 920,968 930,968 940,978 C 950,988 960,988 970,978 C 980,968 990,968 1000,978" stroke="#4a8ab5" stroke-width="1.8" fill="none" />
                <path d="M 800,990 C 810,982 820,982 830,990 C 840,998 850,998 860,990 C 870,982 880,982 890,990 C 900,998 910,998 920,990 C 930,982 940,982 950,990 C 960,998 970,998 980,990 C 990,982 1000,982 1000,990" stroke="#4a8ab5" stroke-width="1.5" fill="none" />
            </svg>

            <div class="annotation" style="top: 62%; left: 2%;"><strong>At surface:</strong> <span id="d3-s1-t-c">18</span>°C / <span id="d3-s1-t-f">64</span>°F<br>Dew Point = <span id="d3-s1-d-c">3</span>°C / <span id="d3-s1-d-f">37</span>°F</div>
            <div class="annotation" style="top: 79%; left: 25%;"><strong>At surface:</strong> <span id="d3-s2-t-c">24</span>°C / <span id="d3-s2-t-f">76</span>°F<br>Dew Point = <span id="d3-s2-d-c">9</span>°C / <span id="d3-s2-d-f">49</span>°F</div>
            <div class="annotation" style="top: 93%; left: 48.5%;"><strong>At surface:</strong> <span id="d3-s3-t-c">29</span>°C / <span id="d3-s3-t-f">85</span>°F<br>Dew Point = <span id="d3-s3-d-c">13</span>°C / <span id="d3-s3-d-f">55</span>°F</div>
            <div style="position: absolute; top: 75%; left: 10%; font-size: 24px; font-style: italic; color: #777; font-family: serif; opacity: 0.4;">Mountain</div>

            <div class="grid-line" style="top: 0.0%;"><div class="label-container"><span class="temp-c" id="d3-alt-16000-c">0°C</span><span class="temp-f" id="d3-alt-16000-f">/ 32°F</span><span class="alt-tag">16,000'</span></div></div>
            <div class="grid-line" style="top: 6.25%;"><div class="label-container"><span class="temp-c" id="d3-alt-15000-c">0°C</span><span class="temp-f" id="d3-alt-15000-f">/ 32°F</span><span class="alt-tag">15,000'</span></div></div>
            <div class="grid-line" style="top: 12.5%;"><div class="label-container"><span class="temp-c" id="d3-alt-14000-c">0°C</span><span class="temp-f" id="d3-alt-14000-f">/ 32°F</span><span class="alt-tag">14,000'</span></div></div>
            <div class="grid-line" style="top: 18.75%;"><div class="label-container"><span class="temp-c" id="d3-alt-13000-c">0°C</span><span class="temp-f" id="d3-alt-13000-f">/ 32°F</span><span class="alt-tag">13,000'</span></div></div>
            <div class="grid-line" style="top: 25.0%;"><div class="label-container"><span class="temp-c" id="d3-alt-12000-c">0°C</span><span class="temp-f" id="d3-alt-12000-f">/ 32°F</span><span class="alt-tag">12,000'</span></div></div>
            <div class="grid-line" style="top: 31.25%;"><div class="label-container"><span class="temp-c" id="d3-alt-11000-c">0°C</span><span class="temp-f" id="d3-alt-11000-f">/ 32°F</span><span class="alt-tag">11,000'</span></div></div>
            <div class="grid-line" style="top: 37.5%;"><div class="label-container"><span class="temp-c" id="d3-alt-10000-c">0°C</span><span class="temp-f" id="d3-alt-10000-f">/ 32°F</span><span class="alt-tag">10,000'</span></div></div>
            <div class="grid-line" style="top: 43.75%;"><div class="label-container"><span class="temp-c" id="d3-alt-9000-c">0°C</span><span class="temp-f" id="d3-alt-9000-f">/ 32°F</span><span class="alt-tag">9,000'</span></div></div>
            <div class="grid-line" style="top: 50.0%;"><div class="label-container"><span class="temp-c" id="d3-alt-8000-c">0°C</span><span class="temp-f" id="d3-alt-8000-f">/ 32°F</span><span class="alt-tag">8,000'</span></div></div>
            <div class="grid-line" style="top: 56.25%;"><div class="label-container"><span class="temp-c" id="d3-alt-7000-c">0°C</span><span class="temp-f" id="d3-alt-7000-f">/ 32°F</span><span class="alt-tag">7,000'</span></div></div>
            <div class="grid-line" style="top: 62.5%;"><div class="label-container"><span class="temp-c" id="d3-alt-6000-c">0°C</span><span class="temp-f" id="d3-alt-6000-f">/ 32°F</span><span class="alt-tag">6,000'</span></div></div>
            <div class="grid-line" style="top: 68.75%;"><div class="label-container"><span class="temp-c" id="d3-alt-5000-c">0°C</span><span class="temp-f" id="d3-alt-5000-f">/ 32°F</span><span class="alt-tag">5,000'</span></div></div>
            <div class="grid-line" style="top: 75.0%;"><div class="label-container"><span class="temp-c" id="d3-alt-4000-c">0°C</span><span class="temp-f" id="d3-alt-4000-f">/ 32°F</span><span class="alt-tag">4,000'</span></div></div>
            <div class="grid-line" style="top: 81.25%;"><div class="label-container"><span class="temp-c" id="d3-alt-3000-c">0°C</span><span class="temp-f" id="d3-alt-3000-f">/ 32°F</span><span class="alt-tag">3,000'</span></div></div>
            <div class="grid-line" style="top: 87.5%;"><div class="label-container"><span class="temp-c" id="d3-alt-2000-c">0°C</span><span class="temp-f" id="d3-alt-2000-f">/ 32°F</span><span class="alt-tag">2,000'</span></div></div>
            <div class="grid-line" style="top: 93.75%;"><div class="label-container"><span class="temp-c" id="d3-alt-1000-c">0°C</span><span class="temp-f" id="d3-alt-1000-f">/ 32°F</span><span class="alt-tag">1,000'</span></div></div>

        </div>
    </div>
</body>
</html>